<svg width="1400" height="860" viewBox="0 0 1400 860" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="MetaClaw control loop architecture">
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#0a1222"/>
      <stop offset="50%" stop-color="#10284a"/>
      <stop offset="100%" stop-color="#17395e"/>
    </linearGradient>
    <linearGradient id="planeA" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#312e81"/>
      <stop offset="100%" stop-color="#4338ca"/>
    </linearGradient>
    <linearGradient id="planeB" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#14532d"/>
      <stop offset="100%" stop-color="#15803d"/>
    </linearGradient>
    <linearGradient id="planeC" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#7c2d12"/>
      <stop offset="100%" stop-color="#c2410c"/>
    </linearGradient>
    <linearGradient id="cardBlue" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#2563eb"/>
      <stop offset="100%" stop-color="#1d4ed8"/>
    </linearGradient>
    <linearGradient id="cardPurple" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#7c3aed"/>
      <stop offset="100%" stop-color="#6d28d9"/>
    </linearGradient>
    <linearGradient id="cardAmber" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#f59e0b"/>
      <stop offset="100%" stop-color="#d97706"/>
    </linearGradient>
    <linearGradient id="cardSlate" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#334155"/>
      <stop offset="100%" stop-color="#1e293b"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="10" stdDeviation="10" flood-color="#020617" flood-opacity="0.35"/>
    </filter>
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#dbeafe"/>
    </marker>
    <marker id="arrowLoop" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#34d399"/>
    </marker>
    <style>
      .title { font: 700 44px 'Avenir Next', 'Segoe UI', sans-serif; fill: #f8fafc; }
      .subtitle { font: 500 20px 'Avenir Next', 'Segoe UI', sans-serif; fill: #cbd5e1; }
      .plane { font: 700 20px 'Avenir Next', 'Segoe UI', sans-serif; fill: #f8fafc; }
      .h { font: 700 28px 'Avenir Next', 'Segoe UI', sans-serif; fill: #f8fafc; }
      .b { font: 500 18px 'Avenir Next', 'Segoe UI', sans-serif; fill: #e2e8f0; }
      .small { font: 500 16px 'Avenir Next', 'Segoe UI', sans-serif; fill: #cbd5e1; }
      .chip { font: 700 18px 'Avenir Next', 'Segoe UI', sans-serif; fill: #fde68a; }
      .link { stroke: #dbeafe; stroke-width: 3; fill: none; marker-end: url(#arrow); }
      .loop { stroke: #34d399; stroke-width: 3; fill: none; marker-end: url(#arrowLoop); }
    </style>
  </defs>

  <rect width="1400" height="860" fill="url(#bg)"/>
  <circle cx="1220" cy="160" r="200" fill="#38bdf8" opacity="0.10"/>
  <circle cx="220" cy="760" r="230" fill="#22c55e" opacity="0.08"/>

  <text x="56" y="74" class="title">MetaClaw Control Loop</text>
  <text x="56" y="108" class="subtitle">Define intent -> compile policies -> execute isolated bot -> collect evidence -> iterate safely</text>

  <rect x="56" y="138" width="1288" height="204" rx="22" fill="url(#planeA)" opacity="0.32"/>
  <text x="84" y="172" class="plane">Authoring Plane</text>

  <rect x="86" y="188" width="280" height="136" rx="16" fill="url(#cardPurple)" filter="url(#shadow)"/>
  <text x="106" y="226" class="h">Intent</text>
  <text x="106" y="252" class="small">目标 / constraints / risk level</text>
  <text x="106" y="276" class="small">who approves what</text>

  <rect x="408" y="188" width="360" height="136" rx="16" fill="url(#cardBlue)" filter="url(#shadow)"/>
  <text x="430" y="226" class="h">Agent Definition</text>
  <text x="430" y="252" class="small">Clawfile + skills + image entrypoint</text>
  <text x="430" y="276" class="small">mount/network/lifecycle contract</text>

  <rect x="810" y="188" width="504" height="136" rx="16" fill="url(#cardAmber)" filter="url(#shadow)"/>
  <text x="832" y="226" class="h">MetaClaw Compiler</text>
  <text x="832" y="252" class="small">validate -> policy compile -> capsule + locks</text>
  <text x="832" y="276" class="small">runtime plan + secret injection contract</text>

  <rect x="56" y="370" width="1288" height="236" rx="22" fill="url(#planeB)" opacity="0.30"/>
  <text x="84" y="404" class="plane">Execution Plane</text>

  <rect x="92" y="424" width="1248" height="162" rx="18" fill="#0f172a" opacity="0.95" filter="url(#shadow)"/>
  <text x="120" y="464" class="h">Isolated Habitat (Per Bot)</text>
  <text x="120" y="492" class="b">Runtime adapter: Apple Container / Podman / Docker</text>
  <text x="120" y="520" class="b">Policy enforced at boundary: mounts / network / env / secrets</text>
  <text x="120" y="548" class="b">Lifecycle: ephemeral or detached daemon</text>

  <rect x="756" y="450" width="540" height="112" rx="14" fill="url(#cardSlate)" opacity="0.95"/>
  <text x="778" y="486" class="chip">Bot Instance</text>
  <text x="778" y="512" class="small">business logic + tools + memory running inside habitat</text>
  <text x="778" y="536" class="small">no implicit access outside declared contract</text>

  <rect x="56" y="634" width="1288" height="170" rx="22" fill="url(#planeC)" opacity="0.28"/>
  <text x="84" y="668" class="plane">Control And Evidence Plane</text>

  <rect x="86" y="686" width="402" height="104" rx="14" fill="url(#cardSlate)" filter="url(#shadow)"/>
  <text x="108" y="720" class="h">State + Events</text>
  <text x="108" y="746" class="small">SQLite state, run logs, inspect/debug traces</text>

  <rect x="520" y="686" width="392" height="104" rx="14" fill="url(#cardSlate)" filter="url(#shadow)"/>
  <text x="542" y="720" class="h">Capsule + Locks</text>
  <text x="542" y="746" class="small">reproducible artifact, digest pinning, diffability</text>

  <rect x="944" y="686" width="372" height="104" rx="14" fill="url(#cardSlate)" filter="url(#shadow)"/>
  <text x="966" y="720" class="h">Outputs + Integrations</text>
  <text x="966" y="746" class="small">models/tools used under policy, controlled write-back</text>

  <path d="M 366 256 C 382 256, 392 256, 408 256" class="link"/>
  <path d="M 768 256 C 784 256, 794 256, 810 256" class="link"/>
  <path d="M 1062 324 C 1062 360, 980 396, 980 424" class="link"/>
  <path d="M 980 586 C 980 620, 980 646, 980 686" class="link"/>
  <path d="M 122 746 C 40 720, 32 232, 86 228" class="loop"/>
</svg>
