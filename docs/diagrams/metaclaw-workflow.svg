<svg width="1400" height="760" viewBox="0 0 1400 760" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="MetaClaw agent execution workflow">
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#0b1220"/>
      <stop offset="55%" stop-color="#10243f"/>
      <stop offset="100%" stop-color="#17365c"/>
    </linearGradient>
    <linearGradient id="cardA" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#6d28d9"/>
      <stop offset="100%" stop-color="#7c3aed"/>
    </linearGradient>
    <linearGradient id="cardB" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#1d4ed8"/>
      <stop offset="100%" stop-color="#2563eb"/>
    </linearGradient>
    <linearGradient id="cardC" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#a16207"/>
      <stop offset="100%" stop-color="#d97706"/>
    </linearGradient>
    <linearGradient id="cardD" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#0f766e"/>
      <stop offset="100%" stop-color="#0d9488"/>
    </linearGradient>
    <linearGradient id="panel" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#ffffff" stop-opacity="0.12"/>
      <stop offset="100%" stop-color="#ffffff" stop-opacity="0.05"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="10" stdDeviation="10" flood-color="#020617" flood-opacity="0.35"/>
    </filter>
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#cbd5e1"/>
    </marker>
    <marker id="arrowLoop" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#34d399"/>
    </marker>
    <style>
      .title { font: 700 40px 'Avenir Next', 'Segoe UI', sans-serif; fill: #f8fafc; }
      .subtitle { font: 500 19px 'Avenir Next', 'Segoe UI', sans-serif; fill: #cbd5e1; }
      .h { font: 700 22px 'Avenir Next', 'Segoe UI', sans-serif; fill: #f8fafc; }
      .b { font: 500 16px 'Avenir Next', 'Segoe UI', sans-serif; fill: #e2e8f0; }
      .small { font: 500 14px 'Avenir Next', 'Segoe UI', sans-serif; fill: #cbd5e1; }
      .chip { font: 700 15px 'Avenir Next', 'Segoe UI', sans-serif; fill: #fde68a; }
      .link { stroke: #cbd5e1; stroke-width: 2.5; fill: none; marker-end: url(#arrow); }
      .linkSoft { stroke: #93c5fd; stroke-width: 2.2; fill: none; marker-end: url(#arrow); }
      .linkWarn { stroke: #fde68a; stroke-width: 2.2; fill: none; marker-end: url(#arrow); }
      .loop { stroke: #34d399; stroke-width: 2.4; fill: none; marker-end: url(#arrowLoop); opacity: 0.92; }
    </style>
  </defs>

  <rect width="1400" height="760" fill="url(#bg)"/>
  <circle cx="1200" cy="140" r="180" fill="#38bdf8" opacity="0.10"/>
  <circle cx="250" cy="690" r="220" fill="#22c55e" opacity="0.08"/>

  <text x="56" y="70" class="title">MetaClaw Agent Execution Workflow</text>
  <text x="56" y="102" class="subtitle">Loop: intent -> agent definition -> engine compile/run -> isolated habitat -> bot execution -> controlled outputs</text>

  <rect x="56" y="150" width="260" height="182" rx="18" fill="url(#cardA)" filter="url(#shadow)"/>
  <rect x="56" y="150" width="260" height="182" rx="18" fill="url(#panel)"/>
  <text x="78" y="194" class="h">User Intent</text>
  <text x="78" y="222" class="b">- Defines target outcome</text>
  <text x="78" y="247" class="b">- Chooses capability scope</text>
  <text x="78" y="272" class="b">- Sets safety expectations</text>
  <text x="78" y="297" class="b">- Keeps keys in host env</text>

  <rect x="340" y="150" width="310" height="182" rx="18" fill="url(#cardB)" filter="url(#shadow)"/>
  <rect x="340" y="150" width="310" height="182" rx="18" fill="url(#panel)"/>
  <text x="364" y="194" class="h">Agent Definition</text>
  <text x="364" y="222" class="b">- Clawfile policy + mounts + lifecycle</text>
  <text x="364" y="247" class="b">- Bot code/image entrypoint</text>
  <text x="364" y="272" class="b">- Skills + memory/retrieval config</text>
  <text x="364" y="297" class="b">- Example repo or custom project</text>

  <rect x="674" y="150" width="300" height="182" rx="18" fill="url(#cardC)" filter="url(#shadow)"/>
  <rect x="674" y="150" width="300" height="182" rx="18" fill="url(#panel)"/>
  <text x="698" y="194" class="h">MetaClaw Engine</text>
  <text x="698" y="222" class="b">- validate -> compile -> run</text>
  <text x="698" y="247" class="b">- enforce habitat policy gates</text>
  <text x="698" y="272" class="b">- lifecycle: ephemeral or detached</text>
  <text x="698" y="297" class="b">- inject secrets by env name only</text>

  <rect x="998" y="138" width="348" height="206" rx="22" fill="#0f172a" opacity="0.95" filter="url(#shadow)"/>
  <rect x="998" y="138" width="348" height="206" rx="22" fill="url(#panel)"/>
  <text x="1022" y="182" class="h">Isolated Habitat (Per Bot)</text>
  <text x="1022" y="210" class="b">- runtime boundary: Apple / Podman / Docker</text>
  <text x="1022" y="235" class="b">- policy-enforced mounts/network/env</text>
  <text x="1022" y="260" class="b">- one bot = one isolated workspace</text>
  <text x="1022" y="285" class="b">- supports ephemeral and detached runs</text>

  <rect x="1032" y="300" width="280" height="64" rx="12" fill="#1e293b" opacity="0.95"/>
  <text x="1050" y="325" class="chip">Bot Instance</text>
  <text x="1050" y="347" class="small">bot process + business logic running in habitat</text>

  <rect x="56" y="420" width="420" height="250" rx="20" fill="url(#cardD)" filter="url(#shadow)"/>
  <rect x="56" y="420" width="420" height="250" rx="20" fill="url(#panel)"/>
  <text x="84" y="464" class="h">Data + Host Integrations</text>
  <text x="84" y="492" class="b">- Explicit mounts define accessible data</text>
  <text x="84" y="517" class="b">- Host runtime/config paths outside habitat</text>
  <text x="84" y="542" class="b">- Controlled write-back via host-side flow</text>
  <text x="84" y="567" class="b">- Auditable logs and state on host</text>
  <text x="84" y="600" class="small">No implicit access outside declared habitat boundaries</text>

  <rect x="500" y="420" width="420" height="250" rx="20" fill="#0b203a" opacity="0.95" filter="url(#shadow)"/>
  <rect x="500" y="420" width="420" height="250" rx="20" fill="url(#panel)"/>
  <text x="528" y="464" class="h">Engine Guarantees</text>
  <text x="528" y="492" class="b">- Security baseline: deny-by-default net/mount/env</text>
  <text x="528" y="517" class="b">- Reproducibility: locks + digest-pinned image</text>
  <text x="528" y="542" class="b">- Auditability: capsule diff + run event traces</text>
  <text x="528" y="567" class="b">- Portability: one contract across runtimes</text>
  <text x="528" y="600" class="small">Engine value beyond one-off scripts</text>

  <rect x="944" y="420" width="402" height="250" rx="20" fill="#10233f" opacity="0.95" filter="url(#shadow)"/>
  <rect x="944" y="420" width="402" height="250" rx="20" fill="url(#panel)"/>
  <text x="972" y="464" class="h">Models + External Tools</text>
  <text x="972" y="492" class="b">- OpenAI-compatible or custom endpoints</text>
  <text x="972" y="517" class="b">- External tools only when policy allows</text>
  <text x="972" y="542" class="b">- Keys injected by env name (runtime only)</text>
  <text x="972" y="567" class="b">- No secret persisted in `.claw` or capsule</text>
  <text x="972" y="600" class="small">Default network mode remains `none` unless allowed</text>

  <path d="M 316 241 C 324 241, 332 241, 340 241" class="link"/>
  <path d="M 650 241 C 658 241, 666 241, 674 241" class="link"/>
  <path d="M 974 241 C 982 241, 990 241, 998 241" class="link"/>

  <path d="M 829 332 C 829 374, 829 388, 829 420" class="linkSoft"/>
  <path d="M 1172 364 C 1172 387, 1172 398, 1172 420" class="linkWarn"/>
  <path d="M 495 332 C 476 370, 426 396, 350 420" class="linkSoft"/>

  <path d="M 84 548 C 18 520, 16 212, 84 198" class="loop"/>
</svg>
